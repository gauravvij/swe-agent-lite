--- a/sphinx/ext/viewcode.py
+++ b/sphinx/ext/viewcode.py
@@ -131,6 +131,9 @@ def collect_pages(app):
     env = app.builder.env
     if not hasattr(env, 'viewcode_modules'):
         return []
+    # Skip generating pages for epub if disabled
+    if app.builder.name.startswith('epub') and not app.config.viewcode_enable_epub:
+        return []
     highlighter = app.builder.highlighter  # type: ignore
     urito = app.builder.get_relative_uri